!function(t){"use strict";function e(e,n,r){var s,l,u,f=this;return n=n||{},u=t.extend(!0,{async:!0,overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(u.errorMessage)})},errorMessage:"There was an error loading the template.",paged:!1,pageNo:1,elemPerPage:10,append:!1,prepend:!1,beforeInsert:null,afterInsert:null,bindingOptions:{ignoreUndefined:!1,ignoreNull:!1,ignoreEmptyString:!1}},r),"array"===t.type(n)?(!0,a.call(this,e,n,u)):(function(t){return"string"==typeof t&&t.indexOf("/")>-1}(e)||(s=t(e),"string"==typeof e&&0===e.indexOf("#")&&(u.isFile=!1)),(l=u.isFile||void 0===u.isFile&&(void 0===s||0===s.length))&&!u.overwriteCache&&m[e]?i(e,f,n,u):l&&!u.overwriteCache&&m.hasOwnProperty(e)?function(t,e,n,a){g[t]?g[t].push({data:n,selection:e,settings:a}):g[t]=[{data:n,selection:e,settings:a}]}(e,f,n,u):l?o(e,f,n,u):c(s,f,n,u),this)}function n(e,n){n?y[e]=n:y=t.extend(y,e)}function a(n,a,i){i=i||{};var r,o=this,c=a.length,s=i.prepend&&!i.append,l=0,u=0,f=!1,p=[];if(i.paged){var d=(i.pageNo-1)*i.elemPerPage;a=a.slice(d,d+i.elemPerPage),c=a.length}return i.append||i.prepend||o.html(""),r=t.extend({},i,{append:!i.prepend&&!0,complete:function(t){(++l===c||f)&&(f&&i&&"function"==typeof i.error&&i.error.call(o,p),i&&"function"==typeof i.complete&&i.complete())},success:function(){++u===c&&i&&"function"==typeof i.success&&i.success()},error:function(t){f=!0,p.push(t)}}),s&&a.reverse(),t(a).each(function(){if(e.call(o,n,this,r),f)return!1}),this}function i(t,e,n,a){var i=m[t].clone();s.call(e,i,n,a),"function"==typeof a.success&&a.success()}function r(){return(new Date).getTime()}function o(e,n,a,i){m[e]=null;var o=e;i.overwriteCache&&(o=function(t){return-1!==t.indexOf("?")?t+"&_="+r():t+"?_="+r()}(o)),t.ajax({url:o,async:i.async,success:function(r){!function(t,e,n,a,i){var r;for(m[e]=t.clone(),s.call(n,t,a,i),"function"==typeof i.success&&i.success.call(n);g[e]&&(r=g[e].shift());)s.call(r.selection,m[e].clone(),r.data,r.settings),"function"==typeof r.settings.success&&r.settings.success.call(r.selection)}(t(r),e,n,a,i)},error:function(t){l(e,n,a,i,t)}})}function c(e,n,a,i){(e.is("script")||e.is("template"))&&(e=t.parseHTML(t.trim(e.html()))),s.call(n,e,a,i),"function"==typeof i.success&&i.success()}function s(e,n,a){(function(e,n,a){u("data-content",e,n=n||{},a,function(t,e){t.html(v(t,e,"content",a))}),u("data-content-append",e,n,a,function(t,e){t.append(v(t,e,"content",a))}),u("data-content-prepend",e,n,a,function(t,e){t.prepend(v(t,e,"content",a))}),u("data-content-text",e,n,a,function(t,e){t.text(v(t,e,"content",a))}),u("data-innerHTML",e,n,a,function(t,e){t.html(v(t,e,"content",a))}),u("data-src",e,n,a,function(t,e){t.attr("src",v(t,e,"src",a))},function(t){t.remove()}),u("data-href",e,n,a,function(t,e){t.attr("href",v(t,e,"href",a))},function(t){t.remove()}),u("data-alt",e,n,a,function(t,e){t.attr("alt",v(t,e,"alt",a))}),u("data-title",e,n,a,function(t,e){t.attr("title",v(t,e,"title",a))}),u("data-id",e,n,a,function(t,e){t.attr("id",v(t,e,"id",a))}),u("data-css",e,n,a,function(t,e){t.css(v(t,e,"css",a))}),u("data-class",e,n,a,function(t,e){t.addClass(v(t,e,"class",a))}),u("data-link",e,n,a,function(e,n){var i=t("<a/>");i.attr("href",v(e,n,"link",a)),i.html(e.html()),e.html(i)}),u("data-link-wrap",e,n,a,function(e,n){var i=t("<a/>");i.attr("href",v(e,n,"link-wrap",a)),e.wrap(i)}),u("data-options",e,n,a,function(e,n){t(n).each(function(){t("<option/>").attr("value",this).text(this).appendTo(e)})}),function(e,n,a){t("[data-template-bind]",e).each(function(){var e=t(this),i=t.parseJSON(e.attr("data-template-bind"));e.removeAttr("data-template-bind"),t(i).each(function(){var i;if(i="object"==typeof this.value?h(n,this.value.data):h(n,this.value),this.attribute){if(!f(this,i,a))return void e.remove();switch(this.attribute){case"content":case"innerHTML":e.html(d(e,i,this));break;case"contentAppend":e.append(d(e,i,this));break;case"contentPrepend":e.prepend(d(e,i,this));break;case"contentText":e.text(d(e,i,this));break;case"options":var r=this;t(i).each(function(){t("<option/>").attr("value",this[r.value.value]).text(d(e,this[r.value.content],r)).attr("selected",null!=typeof this[r.value.selected]&&this[r.value.selected]).appendTo(e)});break;default:e.attr(this.attribute,d(e,i,this))}}})})}(e,n,a),u("data-value",e,n,a,function(t,e){t.val(v(t,e,"value",a))})})(e=t("<div/>").append(e),n,a),t(this).each(function(){var i=e.children().clone(!0);t("select",i).each(function(n,a){t(this).val(t("select",e).eq(n).val())}),a.beforeInsert&&a.beforeInsert(i,n),a.append?t(this).append(i):a.prepend?t(this).prepend(i):t(this).html("").append(i),a.afterInsert&&a.afterInsert(i,n)}),"function"==typeof a.complete&&a.complete.call(t(this),n)}function l(e,n,a,i,r){var o;for("function"==typeof i.error&&i.error.call(n,r),t(g[e]).each(function(t,e){"function"==typeof e.settings.error&&e.settings.error.call(e.selection,r)}),"function"==typeof i.complete&&i.complete.call(n);g[e]&&(o=g[e].shift());)"function"==typeof o.settings.complete&&o.settings.complete.call(o.selection);void 0!==g[e]&&g[e].length>0&&(g[e]=[])}function u(e,n,a,i,r,o){t("["+e+"]",n).each(function(){var n=t(this),c=n.attr(e),s=h(a,c);f(n,s,i)?(n.removeAttr(e),void 0!==s&&r?r(n,s):o&&o(n)):n.remove()})}function f(t,e,n){var a=p(t,n);return!(a.ignoreUndefined&&void 0===e||a.ignoreNull&&null===e||a.ignoreEmptyString&&""===e)}function p(e,n){var a={};return e instanceof jQuery&&e.attr("data-binding-options")?(a=t.parseJSON(e.attr("data-binding-options")),e.removeAttr("data-binding-options")):"object"==typeof e&&e.hasOwnProperty("bindingOptions")&&(a=e.bindingOptions),t.extend({},n.bindingOptions,a)}function d(t,e,n,a){return n.formatter&&y[n.formatter]?function(a){return y[n.formatter].call(t,e,n.formatOptions,a)}(a):e}function h(t,e){if("this"===e)return t;for(var n,a=e.split("."),i=t;(n=a.shift())&&void 0!==i&&null!=i;)i=i[n];return i}function v(e,n,a,i){var r,o=e.attr("data-format-target");if((o===a||!o&&"content"===a)&&(r=e.attr("data-format"))&&"function"==typeof y[r]){var c=e.attr("data-format-options");return function(a){return y[r].call(e[0],n,c,t.extend({},a))}(i)}return n}var m={},g={},y={};n("nestedTemplateFormatter",function(e,n,a){if(n){"string"==typeof n&&"{"===n[0]&&(n=t.parseJSON(n));var i=n.parentElement||"div",r=n.template||n;return n.parentElement?t("<"+i+"/>").loadTemplate(r,e,a):t("<"+i+"/>").loadTemplate(r,e,a).children()}}),t.fn.loadTemplate=e,t.addTemplateFormatter=n}(jQuery);
